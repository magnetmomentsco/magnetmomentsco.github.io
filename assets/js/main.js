document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".navbar"),t=()=>{if(!e)return;e.classList.toggle("scrolled",window.scrollY>50);const t=document.querySelector(".back-to-top");t&&t.classList.toggle("visible",window.scrollY>600)};window.addEventListener("scroll",t,{passive:!0}),t();const o=document.querySelector(".nav-toggle"),n=document.querySelector(".nav-links"),s=document.querySelector(".nav-overlay"),c=()=>{o.classList.remove("active"),n.classList.remove("open"),o.setAttribute("aria-expanded","false"),s&&s.classList.remove("active"),document.body.style.overflow=""};o&&n&&(o.setAttribute("aria-expanded","false"),o.addEventListener("click",()=>{const e=n.classList.toggle("open");if(o.classList.toggle("active"),o.setAttribute("aria-expanded",String(e)),s&&s.classList.toggle("active"),document.body.style.overflow=e?"hidden":"",e){const e=n.querySelector("a, button");e&&e.focus()}}),s&&s.addEventListener("click",c),n.querySelectorAll("a").forEach(e=>{e.addEventListener("click",c)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&n.classList.contains("open")&&(c(),o.focus())}));const r=window.location.pathname.replace(/\/index\.html$/,"/").replace(/\.html$/,"");document.querySelectorAll(".nav-links a").forEach(e=>{const t=e.getAttribute("href");if(!t)return;const o=t.replace(/\/index\.html$/,"/").replace(/\.html$/,"");(o===r||"/"===r&&"/"===o)&&e.classList.add("active")});const a=document.querySelectorAll(".fade-in, .fade-in-left, .fade-in-right, .stagger-children");if(a.length>0){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("visible"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});a.forEach(t=>e.observe(t))}document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".faq-item"),o=t.querySelector(".faq-answer"),n=t.classList.contains("active");document.querySelectorAll(".faq-item.active").forEach(e=>{e.classList.remove("active"),e.querySelector(".faq-answer").style.maxHeight=null,e.querySelector(".faq-question").setAttribute("aria-expanded","false")}),n||(t.classList.add("active"),o.style.maxHeight=o.scrollHeight+"px",e.setAttribute("aria-expanded","true"))})});const i=document.getElementById("newsletter-popup");if(i){sessionStorage.getItem("popup-dismissed")||setTimeout(()=>{i.classList.add("active"),document.dispatchEvent(new CustomEvent("mm:popup-shown"))},4e3);const e=e=>{i.classList.remove("active"),sessionStorage.setItem("popup-dismissed","1"),document.dispatchEvent(new CustomEvent("mm:popup-dismissed",{detail:{method:e||"unknown"}}))};i.querySelector(".popup-close")?.addEventListener("click",()=>e("x")),i.addEventListener("click",t=>{t.target===i&&e("click-outside")}),document.addEventListener("keydown",t=>{"Escape"===t.key&&i.classList.contains("active")&&e("escape")});const t=i.querySelector("form");t&&t.addEventListener("submit",()=>{document.dispatchEvent(new CustomEvent("mm:popup-submitted"))})}document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",o=>{const n=document.querySelector(t.getAttribute("href"));if(n){o.preventDefault();const t=e?e.offsetHeight+20:80,s=n.getBoundingClientRect().top+window.scrollY-t;window.scrollTo({top:s,behavior:"smooth"})}})});const l=document.querySelector(".back-to-top");l&&l.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});if("true"===new URLSearchParams(window.location.search).get("success")){const e=document.querySelector(".contact-form, .newsletter-form");if(e){const t=document.createElement("div");t.setAttribute("role","alert"),t.style.cssText="background:#7A9D54;color:white;padding:1rem 1.5rem;border-radius:8px;text-align:center;margin-bottom:1.5rem;font-weight:600;",t.textContent="âœ“ Message sent! We'll get back to you soon.",e.parentElement.insertBefore(t,e),window.history.replaceState({},"",window.location.pathname)}}const d=document.querySelector(".marquee-inner");if(d){const e=d.closest(".marquee");e?.addEventListener("mouseenter",()=>{d.style.animationPlayState="paused"}),e?.addEventListener("mouseleave",()=>{d.style.animationPlayState="running"})}const u=document.querySelectorAll("[data-count]");if(u.length){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const o=t.target,n=parseInt(o.dataset.count,10),s=o.dataset.suffix||"",c=2e3,r=performance.now(),a=e=>{const t=Math.min((e-r)/c,1),i=1-Math.pow(1-t,3);o.textContent=Math.floor(i*n)+s,t<1&&requestAnimationFrame(a)};requestAnimationFrame(a),e.unobserve(o)}})},{threshold:.5});u.forEach(t=>e.observe(t))}});