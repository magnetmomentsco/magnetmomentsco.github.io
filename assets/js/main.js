document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".navbar"),t=document.querySelector(".back-to-top"),o=()=>{e&&(e.classList.toggle("scrolled",window.scrollY>50),t&&t.classList.toggle("visible",window.scrollY>600))};window.addEventListener("scroll",o,{passive:!0}),o();const s=document.querySelector(".nav-toggle"),n=document.querySelector(".nav-links"),a=document.querySelector(".nav-overlay"),r=()=>{s.classList.remove("active"),n.classList.remove("open"),s.setAttribute("aria-expanded","false"),a&&a.classList.remove("active"),document.body.style.overflow=""};s&&n&&(s.setAttribute("aria-expanded","false"),s.addEventListener("click",()=>{const e=n.classList.toggle("open");if(s.classList.toggle("active"),s.setAttribute("aria-expanded",String(e)),a&&a.classList.toggle("active"),document.body.style.overflow=e?"hidden":"",e){const e=n.querySelector("a, button");e&&e.focus()}}),a&&a.addEventListener("click",r),n.querySelectorAll("a").forEach(e=>{e.addEventListener("click",r)}),document.addEventListener("keydown",e=>{"Escape"===e.key&&n.classList.contains("open")&&(r(),s.focus())}));const c=window.location.pathname.replace(/\/index\.html$/,"/").replace(/\.html$/,"");document.querySelectorAll(".nav-links a").forEach(e=>{const t=e.getAttribute("href");if(!t)return;const o=t.replace(/\/index\.html$/,"/").replace(/\.html$/,"");(o===c||"/"===c&&"/"===o)&&e.classList.add("active")});const i=document.querySelectorAll(".fade-in, .fade-in-left, .fade-in-right, .stagger-children");if(i.length>0){const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(t.target.classList.add("visible"),e.unobserve(t.target))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});i.forEach(t=>e.observe(t))}document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".faq-item"),o=t.querySelector(".faq-answer"),s=t.classList.contains("active");document.querySelectorAll(".faq-item.active").forEach(e=>{e.classList.remove("active"),e.querySelector(".faq-answer").style.maxHeight=null,e.querySelector(".faq-question").setAttribute("aria-expanded","false")}),s||(t.classList.add("active"),o.style.maxHeight=o.scrollHeight+"px",e.setAttribute("aria-expanded","true"))})});const l=document.getElementById("newsletter-popup");if(l){sessionStorage.getItem("popup-dismissed")||setTimeout(()=>{l.classList.add("active"),document.dispatchEvent(new CustomEvent("mm:popup-shown"))},4e3);const e=e=>{l.classList.remove("active"),sessionStorage.setItem("popup-dismissed","1"),document.dispatchEvent(new CustomEvent("mm:popup-dismissed",{detail:{method:e||"unknown"}}))};l.querySelector(".popup-close")?.addEventListener("click",()=>e("x")),l.addEventListener("click",t=>{t.target===l&&e("click-outside")}),document.addEventListener("keydown",t=>{"Escape"===t.key&&l.classList.contains("active")&&e("escape")});const t=l.querySelector("form");t&&t.addEventListener("submit",()=>{document.dispatchEvent(new CustomEvent("mm:popup-submitted"))})}let d=e?e.offsetHeight:60;window.addEventListener("resize",()=>{e&&(d=e.offsetHeight)},{passive:!0}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",t=>{const o=document.querySelector(e.getAttribute("href"));if(o){t.preventDefault();const e=o.getBoundingClientRect().top+window.scrollY-d-20;window.scrollTo({top:e,behavior:"smooth"})}})}),t&&t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});if("true"===new URLSearchParams(window.location.search).get("success")){const e=document.querySelector(".contact-form, .newsletter-form");if(e){const t=document.createElement("div");t.setAttribute("role","alert"),t.style.cssText="background:#7A9D54;color:white;padding:1rem 1.5rem;border-radius:8px;text-align:center;margin-bottom:1.5rem;font-weight:600;",t.textContent="âœ“ Message sent! We'll get back to you soon.",e.parentElement.insertBefore(t,e),window.history.replaceState({},"",window.location.pathname)}}const u=document.querySelector(".marquee-inner");if(u){const e=u.closest(".marquee");e?.addEventListener("mouseenter",()=>{u.style.animationPlayState="paused"}),e?.addEventListener("mouseleave",()=>{u.style.animationPlayState="running"})}const m=document.querySelectorAll("[data-count]");if(m.length){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const o=t.target,s=parseInt(o.dataset.count,10),n=o.dataset.suffix||"",a=2e3,r=performance.now(),c=e=>{const t=Math.min((e-r)/a,1),i=1-Math.pow(1-t,3);o.textContent=Math.floor(i*s)+n,t<1&&requestAnimationFrame(c)};requestAnimationFrame(c),e.unobserve(o)}})},{threshold:.5});m.forEach(t=>e.observe(t))}});